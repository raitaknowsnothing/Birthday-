import { useState, useEffect } from "react";
import { motion } from "framer-motion";

export default function MinecraftBalloonPop() {
  const [balloons, setBalloons] = useState([]);
  const [popped, setPopped] = useState(0);
  const goal = 5;

  useEffect(() => {
    const spawn = setInterval(() => {
      setBalloons((prev) => [
        ...prev,
        {
          id: Math.random(),
          x: Math.random() * 80 + 10,
          y: 100,
        },
      ]);
    }, 800);
    return () => clearInterval(spawn);
  }, []);

  const popBalloon = (id) => {
    setBalloons((prev) => prev.filter((b) => b.id !== id));
    setPopped((n) => n + 1);
  };

  return (
    <div className="w-full h-screen bg-[#87ceeb] relative overflow-hidden" style={{
      backgroundImage:
        "url('https://i.imgur.com/Jp6Jt4r.png')", // Minecraft-style sky
      backgroundSize: "cover",
    }}>
      <div className="absolute top-4 left-4 text-2xl font-bold text-white drop-shadow-lg">
        Pops: {popped} / {goal}
      </div>

      {popped >= goal && (
        <div className="absolute top-1/3 left-1/2 -translate-x-1/2 text-4xl font-extrabold text-yellow-300 drop-shadow-xl bg-black/60 p-6 rounded-2xl">
          ðŸŽ‰ You Win! Messi would be proud! ðŸ”µðŸ”´
        </div>
      )}

      {/* Messi / BarÃ§a pixel banner */}
      <div className="absolute top-0 right-0 p-4">
        <img
          src="https://i.imgur.com/L8KQy2V.png" // pixel Messi head
          className="w-20 h-20"
        />
      </div>

      {/* Pixel grass */}
      <div
        className="absolute bottom-0 w-full h-32"
        style={{
          backgroundImage:
            "url('https://i.imgur.com/8XJQfPp.png')", // Minecraft grass block
          backgroundRepeat: "repeat-x",
          backgroundSize: "contain",
        }}
      />

      {balloons.map((balloon) => (
        <motion.div
          key={balloon.id}
          initial={{ y: "100%" }}
          animate={{ y: "-10%" }}
          transition={{ duration: 4, ease: "linear" }}
          onClick={() => popBalloon(balloon.id)}
          className="absolute cursor-pointer"
          style={{ left: `${balloon.x}%` }}
        >
          <img
            src="https://i.imgur.com/2bZQF3y.png" // pixel football balloon
            className="w-16 h-16"
          />
        </motion.div>
      ))}
    </div>
  );
}